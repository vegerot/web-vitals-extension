var t,n,e=function(){var t=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},i=function(t){if("loading"===document.readyState)return"loading";var n=e();if(n){if(t<n.domInteractive)return"loading";if(0===n.domContentLoadedEventStart||t<n.domContentLoadedEventStart)return"dom-interactive";if(0===n.domComplete||t<n.domComplete)return"dom-content-loaded"}return"complete"},a=function(t){var n=t.nodeName;return 1===t.nodeType?n.toLowerCase():n.toUpperCase().replace(/^#/,"")},r=function(t,n){var e="";try{for(;t&&9!==t.nodeType;){var i=t,r=i.id?"#"+i.id:a(i)+(i.classList&&i.classList.value&&i.classList.value.trim()&&i.classList.value.trim().length?"."+i.classList.value.trim().replace(/\s+/g,"."):"");if(e.length+r.length>(n||100)-1)return e||r;if(e=e?r+">"+e:r,i.id)break;t=i.parentNode}}catch(t){}return e},o=function(t,n,e,i){var a,r;return function(o){n.value>=0&&(o||i)&&((r=n.value-(a||0))||void 0===a)&&(a=n.value,n.delta=r,n.rating=function(t,n){return t>n[1]?"poor":t>n[0]?"needs-improvement":"good"}(n.value,e),t(n))}},c=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},s=-1,u=function(){return s},f=function(t){addEventListener("pageshow",(function(n){n.persisted&&(s=n.timeStamp,t(n))}),!0)},v=function(){var t=e();return t&&t.activationStart||0},d=function(t,n,i,a){var r,o=(null===(r=e())||void 0===r?void 0:r.navigationId)||"1",c=e(),s="navigate";i?s=i:u()>=0?s="back-forward-cache":c&&(document.prerendering||v()>0?s="prerender":document.wasDiscarded?s="restore":c.type&&(s=c.type.replace(/_/g,"-")));return{name:t,value:void 0===n?-1:n,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:s,navigationId:a||o}},g=function(t){return PerformanceObserver.supportedEntryTypes.includes("soft-navigation")&&t&&t.reportSoftNavs},l=function(t){if(t){var n=window.performance.getEntriesByType("soft-navigation").filter((function(n){return n.navigationId===t}));return n?n[0]:void 0}},m=function(t,n,e){var i=g(e);try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var a=new PerformanceObserver((function(t){Promise.resolve().then((function(){n(t.getEntries())}))}));return a.observe(Object.assign({type:t,buffered:!0,includeSoftNavigationObservations:i},e||{})),a}}catch(t){}},p=function(t){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&t()}))},h=function(t){var n=!1;return function(){n||(t(),n=!0)}},T=-1,I=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},y=function(t){"hidden"===document.visibilityState&&T>-1&&(T="visibilitychange"===t.type?t.timeStamp:0,S())},E=function(){addEventListener("visibilitychange",y,!0),addEventListener("prerenderingchange",y,!0)},S=function(){removeEventListener("visibilitychange",y,!0),removeEventListener("prerenderingchange",y,!0)},b=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(T=-1),T<0&&(T=I(),E(),f((function(){setTimeout((function(){T=I(),E()}),0)}))),{get firstHiddenTime(){return T}}},C=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},w=[1800,3e3],L=function(t,n){var i,a=g(n=n||{}),r=0,s=(null===(i=e())||void 0===i?void 0:i.navigationId)||"1";C((function(){var e,i=b(),u=d("FCP"),g=m("paint",(function(c){c.forEach((function(c){if("first-contentful-paint"===c.name){a?c.navigationId&&c.navigationId!==u.navigationId&&function(a,c){if(u=d("FCP",0,a,c),e=o(t,u,w,n.reportAllChanges),"soft-navigation"===a){i=b(!0);var s=c?l(c):null;r=s&&s.startTime||0}}("soft-navigation",c.navigationId):g.disconnect();var f=0;if(c.navigationId&&c.navigationId!==s){var m=l(c.navigationId),p=m&&m.startTime?m.startTime:0;f=Math.max(c.startTime-p,0)}else f=Math.max(c.startTime-v(),0);var h=a&&c.navigationId?l(c.navigationId):null,T=h&&h.startTime?h.startTime:0;(c.startTime<i.firstHiddenTime||a&&c.navigationId&&c.navigationId!==u.navigationId&&c.navigationId!==s&&T>r)&&(u.value=f,u.entries.push(c),u.navigationId=c.navigationId||"1",e(!0))}}))}),n);g&&(e=o(t,u,w,n.reportAllChanges),f((function(i){u=d("FCP",0,"back-forward-cache",u.navigationId),e=o(t,u,w,n.reportAllChanges),c((function(){u.value=performance.now()-i.timeStamp,e(!0)}))})))}))},M=[.1,.25],D=function(t,n){!function(t,n){var e=g(n=n||{}),i=!1,a=0;L(h((function(){var r,s=d("CLS",0),u=0,v=[],g=function(e,c){if(s=d("CLS",0,e,c),r=o(t,s,M,n.reportAllChanges),u=0,i=!1,"soft-navigation"===e){var f=l(c);a=f&&f.startTime||0}},h=function(t){t.forEach((function(t){if(e&&t.navigationId&&t.navigationId!==s.navigationId&&(u>s.value&&(s.value=u,s.entries=v),r(!0),g("soft-navigation",t.navigationId)),!t.hadRecentInput){var n=v[0],i=v[v.length-1];u&&t.startTime-i.startTime<1e3&&t.startTime-n.startTime<5e3?(u+=t.value,v.push(t)):(u=t.value,v=[t])}})),u>s.value&&(s.value=u,s.entries=v,r())},T=m("layout-shift",h,n);T&&(r=o(t,s,M,n.reportAllChanges),p((function(){h(T.takeRecords()),r(!0),i=!0})),f((function(){g("back-forward-cache",s.navigationId),c((function(){return r()}))})),e&&m("soft-navigation",(function(e){e.forEach((function(e){var c=e.navigationId,u=c?l(c):null;c&&c!==s.navigationId&&u&&(u.startTime||0)>a&&(i||r(!0),g("soft-navigation",e.navigationId),r=o(t,s,M,n.reportAllChanges))}))}),n),setTimeout(r,0))})))}((function(n){var e=function(t){var n,e={};if(t.entries.length){var a=t.entries.reduce((function(t,n){return t&&t.value>n.value?t:n}));if(a&&a.sources&&a.sources.length){var o=(n=a.sources).find((function(t){return t.node&&1===t.node.nodeType}))||n[0];o&&(e={largestShiftTarget:r(o.node),largestShiftTime:a.startTime,largestShiftValue:a.value,largestShiftSource:o,largestShiftEntry:a,loadState:i(a.startTime)})}}return Object.assign(t,{attribution:e})}(n);t(e)}),n)},k=function(t,n){L((function(n){var a=function(t){var n,a=(null===(n=e())||void 0===n?void 0:n.navigationId)||"1",r={timeToFirstByte:0,firstByteToFCP:t.value,loadState:i(u())};if(t.entries.length){var o,c=t.entries[t.entries.length-1],s=0;if(t.navigationId&&t.navigationId!==a)s=(o=l(t.navigationId))?o.startTime:0;else if(o=e()){var f=o.responseStart,v=o.activationStart||0;s=Math.max(0,f-v)}o&&(r={timeToFirstByte:s,firstByteToFCP:t.value-s,loadState:i(t.entries[0].startTime),navigationEntry:o,fcpEntry:c})}return Object.assign(t,{attribution:r})}(n);t(a)}),n)},x=0,A=1/0,F=0,P="",B=!1,O=function(t){var n;P||(P=(null===(n=e())||void 0===n?void 0:n.navigationId)||"1"),t.forEach((function(t){t.interactionId&&(B&&t.navigationId&&t.navigationId!==P&&(P=t.navigationId,x=0,A=1/0,F=0),A=Math.min(A,t.interactionId),F=Math.max(F,t.interactionId),x=F?(F-A)/7+1:0)}))},N=function(){return t?x:performance.interactionCount||0},R=function(n){"interactionCount"in performance||t||(t=m("event",O,{type:"event",buffered:!0,durationThreshold:0,includeSoftNavigationObservations:B=n||!1}))},j=[],q=new Map,H=0,W=function(){H=N(),j.length=0,q.clear()},z=function(){var t=Math.min(j.length-1,Math.floor((N()-H)/50));return j[t]},U=[],V=function(t){if(U.forEach((function(n){return n(t)})),t.interactionId||"first-input"===t.entryType){var n=j[j.length-1],e=q.get(t.interactionId);if(e||j.length<10||t.duration>n.latency){if(e)t.duration>e.latency?(e.entries=[t],e.latency=t.duration):t.duration===e.latency&&t.startTime===e.entries[0].startTime&&e.entries.push(t);else{var i={id:t.interactionId,latency:t.duration,entries:[t]};q.set(i.id,i),j.push(i)}j.sort((function(t,n){return n.latency-t.latency})),j.length>10&&j.splice(10).forEach((function(t){return q.delete(t.id)}))}}},_=function(t){var n=self.requestIdleCallback||self.setTimeout,e=-1;return t=h(t),"hidden"===document.visibilityState?t():(e=n(t),p(t)),e},G=[200,500],J=function(t,n){if("PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype){var e=g(n=n||{}),i=!1,a=0;C((function(){var r;R(e);var s,u=d("INP"),v=function(e,r){if(W(),u=d("INP",0,e,r),s=o(t,u,G,n.reportAllChanges),i=!1,"soft-navigation"===e){var c=l(r);a=c&&c.startTime?c.startTime:0}},g=function(t){_((function(){var e;t.forEach(V),(e=z())&&(e.latency!==u.value||n&&n.reportAllChanges)&&(u.value=e.latency,u.entries=e.entries),s()}))},h=m("event",g,{durationThreshold:null!==(r=n.durationThreshold)&&void 0!==r?r:40,opts:n});if(s=o(t,u,G,n.reportAllChanges),h){h.observe({type:"first-input",buffered:!0,includeSoftNavigationObservations:e}),p((function(){g(h.takeRecords()),s(!0)})),f((function(){W(),v("back-forward-cache",u.navigationId),c((function(){return s()}))}));e&&m("soft-navigation",(function(e){e.forEach((function(e){var r=l(e.navigationId),c=r&&r.startTime?r.startTime:0;e.navigationId&&e.navigationId!==u.navigationId&&c>a&&(!i&&u.value>0&&s(!0),v("soft-navigation",e.navigationId),s=o(t,u,G,n.reportAllChanges))}))}),n)}}))}},K=[],Q=[],X=0,Y=new WeakMap,Z=new Map,$=-1,tt=function(t){K=K.concat(t),nt()},nt=function(){$<0&&($=_(et))},et=function(){Z.size>10&&Z.forEach((function(t,n){q.has(n)||Z.delete(n)}));var t=j.map((function(t){return Y.get(t.entries[0])})),n=Q.length-50;Q=Q.filter((function(e,i){return i>=n||t.includes(e)}));for(var e=new Set,i=0;i<Q.length;i++){var a=Q[i];ct(a.startTime,a.processingEnd).forEach((function(t){e.add(t)}))}var r=K.length-1-50;K=K.filter((function(t,n){return t.startTime>X&&n>r||e.has(t)})),$=-1};U.push((function(t){t.interactionId&&t.target&&!Z.has(t.interactionId)&&Z.set(t.interactionId,t.target)}),(function(t){var n,e=t.startTime+t.duration;X=Math.max(X,t.processingEnd);for(var i=Q.length-1;i>=0;i--){var a=Q[i];if(Math.abs(e-a.renderTime)<=8){(n=a).startTime=Math.min(t.startTime,n.startTime),n.processingStart=Math.min(t.processingStart,n.processingStart),n.processingEnd=Math.max(t.processingEnd,n.processingEnd),n.entries.push(t);break}}n||(n={startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,renderTime:e,entries:[t]},Q.push(n)),(t.interactionId||"first-input"===t.entryType)&&Y.set(t,n),nt()}));var it,at,rt,ot,ct=function(t,n){for(var e,i=[],a=0;e=K[a];a++)if(!(e.startTime+e.duration<t)){if(e.startTime>n)break;i.push(e)}return i},st=function(t,e){n||(n=m("long-animation-frame",tt)),J((function(n){var e=function(t){var n=t.entries[0],e=Y.get(n),a=n.processingStart,o=e.processingEnd,c=e.entries.sort((function(t,n){return t.processingStart-n.processingStart})),s=ct(n.startTime,o),u=t.entries.find((function(t){return t.target})),f=u&&u.target||Z.get(n.interactionId),v=[n.startTime+n.duration,o].concat(s.map((function(t){return t.startTime+t.duration}))),d=Math.max.apply(Math,v),g={interactionTarget:r(f),interactionTargetElement:f,interactionType:n.name.startsWith("key")?"keyboard":"pointer",interactionTime:n.startTime,nextPaintTime:d,processedEventEntries:c,longAnimationFrameEntries:s,inputDelay:a-n.startTime,processingDuration:o-a,presentationDelay:Math.max(d-o,0),loadState:i(n.startTime)};return Object.assign(t,{attribution:g})}(n);t(e)}),e)},ut=[2500,4e3],ft=function(t,n){!function(t,n){var i,a=!1,r=g(n=n||{}),s=0,u=(null===(i=e())||void 0===i?void 0:i.navigationId)||"1",h="";C((function(){var e,i=b(),g=d("LCP"),T=function(r,c){if(g=d("LCP",0,r,c),e=o(t,g,ut,n.reportAllChanges),a=!1,"soft-navigation"===r){i=b(!0);var u=l(c);s=u&&u.startTime?u.startTime:0}E()},I=function(t){t.forEach((function(t){if(t){r&&t.navigationId&&t.navigationId!==g.navigationId&&(a||e(!0),T("soft-navigation",t.navigationId));var n=0;if(t.navigationId&&t.navigationId!==u){var o=l(t.navigationId),c=o&&o.startTime?o.startTime:0;n=Math.max(t.startTime-c,0)}else n=Math.max(t.startTime-v(),0);t.startTime<i.firstHiddenTime&&(g.value=n,g.entries=[t],g.navigationId=t.navigationId||u,e())}}))},y=function(){S(),a||(I(w.takeRecords()),r||w.disconnect(),g.navigationId===h&&(a=!0,e(!0)))},E=function(){["keydown","click"].forEach((function(t){addEventListener(t,(function(){return C()}),!0)}))},S=function(){["keydown","click"].forEach((function(t){removeEventListener(t,(function(){return C()}),!0)}))},C=function(){h=g.navigationId,_(y)},w=m("largest-contentful-paint",I,n);w&&(e=o(t,g,ut,n.reportAllChanges),E(),p((function(){h=g.navigationId,y()})),f((function(t){T("back-forward-cache",g.navigationId),c((function(){g.value=performance.now()-t.timeStamp,a=!0,e(!0)}))})),r&&m("soft-navigation",(function(t){t.forEach((function(t){var n=t.navigationId?l(t.navigationId):null;t.navigationId&&t.navigationId!==g.navigationId&&n&&(n.startTime||0)>s&&(a||e(!0),T("soft-navigation",t.navigationId))}))}),n))}))}((function(n){var i=function(t){var n,i=(null===(n=e())||void 0===n?void 0:n.navigationId)||"1",a={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:t.value};if(t.entries.length){var o,c=0,s=0,u=0;if(t.navigationId&&t.navigationId!==i?c=u=(o=l(t.navigationId))?o.startTime:0:(c=(o=e())&&o.activationStart?o.activationStart:0,s=o&&o.responseStart?o.responseStart:0),o){var f=t.entries[t.entries.length-1],v=f.url&&performance.getEntriesByType("resource").filter((function(t){return t.name===f.url}))[0],d=Math.max(0,s-c),g=Math.max(d,v?(v.requestStart||v.startTime)-c:0),m=Math.max(g-u,v?v.responseEnd-c:0,0),p=Math.max(m-u,f?f.startTime-c:0,0);a={element:r(f.element),timeToFirstByte:d,resourceLoadDelay:g-d,resourceLoadDuration:m-g,elementRenderDelay:p-m,navigationEntry:o,lcpEntry:f},f.url&&(a.url=f.url),v&&(a.lcpResourceEntry=v)}}return Object.assign(t,{attribution:a})}(n);t(i)}),n)},vt=[800,1800],dt=function t(n){document.prerendering?C((function(){return t(n)})):"complete"!==document.readyState?addEventListener("load",(function(){return t(n)}),!0):setTimeout(n,0)},gt=function(t,n){var i=g(n=n||{}),a=d("TTFB"),r=o(t,a,vt,n.reportAllChanges);dt((function(){var c=e();if(c){var s=c.responseStart;a.value=Math.max(s-v(),0),a.entries=[c],r(!0),f((function(){a=d("TTFB",0,"back-forward-cache",a.navigationId),(r=o(t,a,vt,n.reportAllChanges))(!0)}));i&&m("soft-navigation",(function(e){e.forEach((function(e){e.navigationId&&((a=d("TTFB",0,"soft-navigation",e.navigationId)).entries=[e],(r=o(t,a,vt,n.reportAllChanges))(!0))}))}),n)}}))},lt=function(t,n){gt((function(n){var e=function(t){var n={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(t.entries.length){var e=t.entries[0],i=e.activationStart||0,a=Math.max((e.workerStart||e.fetchStart)-i,0),r=Math.max(e.domainLookupStart-i||0,0),o=Math.max(e.connectStart-i||0,0),c=Math.max(e.connectEnd-i||0,0);n={waitingDuration:a,cacheDuration:r-a,dnsDuration:o-r,connectionDuration:c-o,requestDuration:t.value-c,navigationEntry:e}}return Object.assign(t,{attribution:n})}(n);t(e)}),n)},mt={passive:!0,capture:!0},pt=new Date,ht=function(t,n){it||(it=n,at=t,rt=new Date,yt(removeEventListener),Tt())},Tt=function(){if(at>=0&&at<rt-pt){var t={entryType:"first-input",name:it.type,target:it.target,cancelable:it.cancelable,startTime:it.timeStamp,processingStart:it.timeStamp+at};ot.forEach((function(n){n([t])})),ot=[]}},It=function(t){if(t.cancelable){var n=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,n){var e=function(){ht(t,n),a()},i=function(){a()},a=function(){removeEventListener("pointerup",e,mt),removeEventListener("pointercancel",i,mt)};addEventListener("pointerup",e,mt),addEventListener("pointercancel",i,mt)}(n,t):ht(n,t)}},yt=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(n){return t(n,It,mt)}))},Et=[100,300],St=function(t,n){var i,a=g(n=n||{}),r=(null===(i=e())||void 0===i?void 0:i.navigationId)||"1";C((function(){var e,i=b(),c=d("FID"),s=function(s){s.forEach((function(s){var f,v;a?s.navigationId&&s.navigationId!==c.navigationId&&(f="soft-navigation",v=s.navigationId,"soft-navigation"===f&&(i=b(!0)),c=d("FID",0,f,v),e=o(t,c,Et,n.reportAllChanges)):u.disconnect(),s.startTime<i.firstHiddenTime&&(c.value=s.processingStart-s.startTime,c.entries.push(s),c.navigationId=s.navigationId||r,e(!0))}))},u=m("first-input",s,n);e=o(t,c,Et,n.reportAllChanges),u&&(p((function(){s(u.takeRecords()),a||u.disconnect()})),f((function(){var i;c=d("FID",0,"back-forward-cache",c.navigationId),e=o(t,c,Et,n.reportAllChanges),ot=[],at=-1,it=null,yt(addEventListener),i=s,ot.push(i),Tt()})))}))},bt=function(t,n){St((function(n){var e=function(t){var n=t.entries[0],e={eventTarget:r(n.target),eventType:n.name,eventTime:n.startTime,eventEntry:n,loadState:i(n.startTime)};return Object.assign(t,{attribution:e})}(n);t(e)}),n)};export{M as CLSThresholds,w as FCPThresholds,Et as FIDThresholds,G as INPThresholds,ut as LCPThresholds,vt as TTFBThresholds,D as onCLS,k as onFCP,bt as onFID,st as onINP,ft as onLCP,lt as onTTFB};
