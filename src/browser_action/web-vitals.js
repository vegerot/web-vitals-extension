class t{t;o=0;i=[];l(t){if(t.hadRecentInput)return;const n=this.i[0],e=this.i.at(-1);this.o&&n&&e&&t.startTime-e.startTime<1e3&&t.startTime-n.startTime<5e3?(this.o+=t.value,this.i.push(t)):(this.o=t.value,this.i=[t]),this.t?.(t)}}const n=()=>{const t=performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},e=t=>{if("loading"===document.readyState)return"loading";{const e=n();if(e){if(t<e.domInteractive)return"loading";if(0===e.domContentLoadedEventStart||t<e.domContentLoadedEventStart)return"dom-interactive";if(0===e.domComplete||t<e.domComplete)return"dom-content-loaded"}}return"complete"},o=t=>{const n=t.nodeName;return 1===t.nodeType?n.toLowerCase():n.toUpperCase().replace(/^#/,"")},i=t=>{let n="";try{for(;9!==t?.nodeType;){const e=t,i=e.id?"#"+e.id:[o(e),...Array.from(e.classList).sort()].join(".");if(n.length+i.length>99)return n||i;if(n=n?i+">"+n:i,e.id)break;t=e.parentNode}}catch{}return n},r=new WeakMap;function a(t,n){return r.get(t)||r.set(t,new n),r.get(t)}let s=-1;const c=()=>s,f=t=>{addEventListener("pageshow",(n=>{n.persisted&&(s=n.timeStamp,t(n))}),!0)},l=(t,n,e,o)=>{let i,r;return a=>{n.value>=0&&(a||o)&&(r=n.value-(i??0),(r||void 0===i)&&(i=n.value,n.delta=r,n.rating=((t,n)=>t>n[1]?"poor":t>n[0]?"needs-improvement":"good")(n.value,e),t(n)))}},u=t=>{requestAnimationFrame((()=>requestAnimationFrame((()=>t()))))},d=t=>PerformanceObserver.supportedEntryTypes.includes("soft-navigation")&&t&&t.reportSoftNavs,h=t=>{if(!t)return;const n=window.performance.getEntriesByType("soft-navigation").filter((n=>n.navigationId===t));return n?n[0]:void 0},g=()=>{const t=n();return t?.activationStart??0};let v=-1;const m=new Set,p=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,y=t=>{if("hidden"===document.visibilityState){if("visibilitychange"===t.type)for(const t of m)t();isFinite(v)||(v="visibilitychange"===t.type?t.timeStamp:0,removeEventListener("prerenderingchange",y,!0))}},b=(t=!1)=>{if(t&&(v=1/0),v<0){const t=g(),n=document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((n=>"hidden"===n.name&&n.startTime>t))[0]?.startTime;v=n??p(),addEventListener("visibilitychange",y,!0),addEventListener("prerenderingchange",y,!0),f((()=>{setTimeout((()=>{v=p()}))}))}return{get firstHiddenTime(){return v},onHidden(t){m.add(t)}}},M=(t,e=-1,o,i)=>{const r=n()?.navigationId||"1",a=n();let s="navigate";o?s=o:c()>=0?s="back-forward-cache":a&&(document.prerendering||g()>0?s="prerender":document.wasDiscarded?s="restore":a.type&&(s=a.type.replace(/_/g,"-")));return{name:t,value:e,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:s,navigationId:i||r,navigationURL:h(i)?.name||n()?.name}},T=(t,n,e={})=>{const o=d(e);try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const i=new PerformanceObserver((t=>{Promise.resolve().then((()=>{n(t.getEntries())}))}));return i.observe(Object.assign({type:t,buffered:!0,includeSoftNavigationObservations:o,...e},e||{})),i}}catch{}},E=t=>{let n=!1;return()=>{n||(t(),n=!0)}},D=t=>{document.prerendering?addEventListener("prerenderingchange",(()=>t()),!0):t()},P=[1800,3e3],w=(t,e={})=>{const o=d(e=e||{});let i=0;const r=n()?.navigationId||"1";D((()=>{let n,a=b(),s=M("FCP");const c=(o,r)=>{if(s=M("FCP",0,o,r),n=l(t,s,P,e.reportAllChanges),"soft-navigation"===o){a=b(!0);const t=r?h(r):null;i=t&&t.startTime||0}},d=T("paint",(t=>{for(const e of t)if("first-contentful-paint"===e.name){o?e.navigationId&&e.navigationId!==s.navigationId&&c("soft-navigation",e.navigationId):d.disconnect();let t=0;if(e.navigationId&&e.navigationId!==r){const n=h(e.navigationId),o=n&&n.startTime?n.startTime:0;t=Math.max(e.startTime-o,0)}else t=Math.max(e.startTime-g(),0);const f=o&&e.navigationId?h(e.navigationId):null,l=f&&f.startTime?f.startTime:0;(e.startTime<a.firstHiddenTime||o&&e.navigationId&&e.navigationId!==s.navigationId&&e.navigationId!==r&&l>i)&&(s.value=t,s.entries.push(e),s.navigationId=e.navigationId||"1",n(!0))}}),e);d&&(n=l(t,s,P,e.reportAllChanges),f((o=>{s=M("FCP",0,"back-forward-cache",s.navigationId),n=l(t,s,P,e.reportAllChanges),u((()=>{s.value=performance.now()-o.timeStamp,n(!0)}))})))}))},L=[.1,.25],S=t=>t.find((t=>1===t.node?.nodeType))||t[0],k=(n,o={})=>{const r=a(o=Object.assign({},o),t),s=new WeakMap;r.t=t=>{if(t?.sources?.length){const n=S(t.sources),e=n?.node;if(e){const t=o.generateTarget?.(e)??i(e);s.set(n,t)}}};((n,e={})=>{const o=d(e);let i=!1,r=0;const s=b();w(E((()=>{let c,d=M("CLS",0);const g=a(e,t),v=(t,o)=>{if(d=M("CLS",0,t,o),g.o=0,c=l(n,d,L,e.reportAllChanges),i=!1,"soft-navigation"===t){const t=h(o);r=t&&t.startTime||0}},m=t=>{for(const n of t)o&&n.navigationId&&n.navigationId!==d.navigationId&&(c(!0),v("soft-navigation",n.navigationId)),g.l(n);g.o>d.value&&(d.value=g.o,d.entries=g.i,c())},p=T("layout-shift",m,e);p&&(c=l(n,d,L,e.reportAllChanges),s.onHidden((()=>{m(p.takeRecords()),c(!0),i=!0})),f((()=>{v("back-forward-cache",d.navigationId),u((()=>c()))})),o&&T("soft-navigation",(t=>{for(const o of t){const t=o.navigationId,a=t?h(t):null;t&&t!==d.navigationId&&a&&(a.startTime||0)>r&&(m(p.takeRecords()),i||c(!0),v("soft-navigation",o.navigationId),c=l(n,d,L,e.reportAllChanges))}}),e),setTimeout(c))})))})((t=>{const o=(t=>{let n={};if(t.entries.length){const o=t.entries.reduce(((t,n)=>t.value>n.value?t:n));if(o?.sources?.length){const t=S(o.sources);t&&(n={largestShiftTarget:s.get(t),largestShiftTime:o.startTime,largestShiftValue:o.value,largestShiftSource:t,largestShiftEntry:o,loadState:e(o.startTime)})}}return Object.assign(t,{attribution:n})})(t);n(o)}),o)},F=(t,o={})=>{w((o=>{const i=(t=>{const o=n()?.navigationId||"1";let i={timeToFirstByte:0,firstByteToFCP:t.value,loadState:e(c())};if(t.entries.length){let r;const a=t.entries.at(-1);let s=0,c=0;if(t.navigationId&&t.navigationId!==o)r=h(t.navigationId),c=r?r.startTime:0,s=c;else if(r=n(),r){const t=r.responseStart,n=r.activationStart||0;s=Math.max(0,t-n)}r&&(i={timeToFirstByte:s,firstByteToFCP:t.value-s,loadState:e(t.entries[0].startTime),navigationEntry:r,fcpEntry:a})}return Object.assign(t,{attribution:i})})(o);t(i)}),o)};let O=0,_=1/0,B=0,C="",I=!1;const j=t=>{C||(C=n()?.navigationId||"1");for(const n of t)n.interactionId&&(I&&n.navigationId&&n.navigationId!==C&&(C=n.navigationId,O=0,_=1/0,B=0),_=Math.min(_,n.interactionId),B=Math.max(B,n.interactionId),O=B?(B-_)/7+1:0)};let A;const N=()=>A?O:performance.interactionCount??0,W=t=>{"interactionCount"in performance||A||(I=t||!1,A=T("event",j,{type:"event",buffered:!0,durationThreshold:0,includeSoftNavigationObservations:I}))};let q=0;class x{u=[];h=new Map;v;m;p(){q=N(),this.u.length=0,this.h.clear()}M(){const t=Math.min(this.u.length-1,Math.floor((N()-q)/50));return this.u[t]}l(t){if(this.v?.(t),!t.interactionId&&"first-input"!==t.entryType)return;const n=this.u.at(-1);let e=this.h.get(t.interactionId);if(e||this.u.length<10||t.duration>n.T){if(e?t.duration>e.T?(e.entries=[t],e.T=t.duration):t.duration===e.T&&t.startTime===e.entries[0].startTime&&e.entries.push(t):(e={id:t.interactionId,entries:[t],T:t.duration},this.h.set(e.id,e),this.u.push(e)),this.u.sort(((t,n)=>n.T-t.T)),this.u.length>10){const t=this.u.splice(10);for(const n of t)this.h.delete(n.id)}this.m?.(e)}}}const R=t=>{const n=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?t():(t=E(t),addEventListener("visibilitychange",t,{once:!0,capture:!0}),n((()=>{t(),removeEventListener("visibilitychange",t,{capture:!0})})))},U=[200,500],H=(t,n={})=>{const e=d(n);let o=!1,i=0;if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;const r=b();D((()=>{W(e);let s,c=M("INP");const d=a(n,x),g=(e,r)=>{if(d.p(),c=M("INP",-1,e,r),s=l(t,c,U,n.reportAllChanges),o=!1,"soft-navigation"===e){const t=h(r);i=t&&t.startTime?t.startTime:0}},v=t=>{0!==t.filter((t=>t.interactionId)).length&&R((()=>{for(const n of t)d.l(n);(()=>{const t=d.M();t&&(t.T!==c.value||n&&n.reportAllChanges)&&(c.value=t.T,c.entries=t.entries)})(),s()}))},m=T("event",v,{durationThreshold:n.durationThreshold??40,opts:n});if(s=l(t,c,U,n.reportAllChanges),m){m.observe({type:"first-input",buffered:!0,includeSoftNavigationObservations:e}),r.onHidden((()=>{v(m.takeRecords()),s(!0)})),f((()=>{d.p(),g("back-forward-cache",c.navigationId),u((()=>s())),c=M("INP"),s=l(t,c,U,n.reportAllChanges)}));e&&T("soft-navigation",(t=>{t.forEach((t=>{const n=h(t.navigationId),e=n&&n.startTime?n.startTime:0;t.navigationId&&t.navigationId!==c.navigationId&&e>i&&R((()=>{v(m.takeRecords()),!o&&c.value>0&&s(!0),g("soft-navigation",t.navigationId)}))}))}),n)}}))},V=(t,n={})=>{const o=a(n=Object.assign({},n),x);let r=[],s=[],c=0;const f=new WeakMap,l=new WeakMap;let u=!1;const d=()=>{u||(R(h),u=!0)},h=()=>{const t=o.u.map((t=>f.get(t.entries[0]))),n=s.length-50;s=s.filter(((e,o)=>o>=n||t.includes(e)));const e=new Set;for(const t of s){const n=g(t.startTime,t.processingEnd);for(const t of n)e.add(t)}const i=r.length-1-50;r=r.filter(((t,n)=>t.startTime>c&&n>i||e.has(t))),u=!1};o.v=t=>{const n=t.startTime+t.duration;let e;c=Math.max(c,t.processingEnd);for(let o=s.length-1;o>=0;o--){const i=s[o];if(Math.abs(n-i.renderTime)<=8){e=i,e.startTime=Math.min(t.startTime,e.startTime),e.processingStart=Math.min(t.processingStart,e.processingStart),e.processingEnd=Math.max(t.processingEnd,e.processingEnd),e.entries.push(t);break}}e||(e={startTime:t.startTime,processingStart:t.processingStart,processingEnd:t.processingEnd,renderTime:n,entries:[t]},s.push(e)),(t.interactionId||"first-input"===t.entryType)&&f.set(t,e),d()},o.m=t=>{if(!l.get(t)){const e=t.entries[0].target;if(e){const o=n.generateTarget?.(e)??i(e);l.set(t,o)}}};const g=(t,n)=>{const e=[];for(const o of r)if(!(o.startTime+o.duration<t)){if(o.startTime>n)break;e.push(o)}return e},v=t=>{const n=t.entries[0],i=f.get(n),r=n.processingStart,a=Math.max(n.startTime+n.duration,r),s=Math.min(i.processingEnd,a),c=i.entries.sort(((t,n)=>t.processingStart-n.processingStart)),u=g(n.startTime,s),d=o.h.get(n.interactionId),h={interactionTarget:l.get(d),interactionType:n.name.startsWith("key")?"keyboard":"pointer",interactionTime:n.startTime,nextPaintTime:a,processedEventEntries:c,longAnimationFrameEntries:u,inputDelay:r-n.startTime,processingDuration:s-r,presentationDelay:a-s,loadState:e(n.startTime),longestScript:void 0,totalScriptDuration:void 0,totalStyleAndLayoutDuration:void 0,totalPaintDuration:void 0,totalUnattributedDuration:void 0};(t=>{if(!t.longAnimationFrameEntries?.length)return;const n=t.interactionTime,e=t.inputDelay,o=t.processingDuration;let i,r,a=0,s=0,c=0,f=0;for(const c of t.longAnimationFrameEntries){s=s+c.startTime+c.duration-c.styleAndLayoutStart;for(const t of c.scripts){const c=t.startTime+t.duration;if(c<n)continue;const l=c-Math.max(n,t.startTime),u=t.duration?l/t.duration*t.forcedStyleAndLayoutDuration:0;a+=l-u,s+=u,l>f&&(r=t.startTime<n+e?"input-delay":t.startTime>=n+e+o?"presentation-delay":"processing-duration",i=t,f=l)}}const l=t.longAnimationFrameEntries.at(-1),u=l?l.startTime+l.duration:0;u>=n+e+o&&(c=t.nextPaintTime-u),i&&r&&(t.longestScript={entry:i,subpart:r,intersectingDuration:f}),t.totalScriptDuration=a,t.totalStyleAndLayoutDuration=s,t.totalPaintDuration=c,t.totalUnattributedDuration=t.nextPaintTime-n-a-s-c})(h);return Object.assign(t,{attribution:h})};T("long-animation-frame",(t=>{r=r.concat(t),d()})),H((n=>{const e=v(n);t(e)}),n)};class ${v;l(t){this.v?.(t)}}const z=[2500,4e3],G=(t,e={})=>{const o=a(e=Object.assign({},e),$),r=new WeakMap;o.v=t=>{const n=t.element;if(n){const o=e.generateTarget?.(n)??i(n);r.set(t,o)}};((t,e={})=>{let o=!1;const i=d(e);let r=0;const s=n()?.navigationId||"1";let c="";D((()=>{let n,d=b(),v=M("LCP");const m=a(e,$),p=(i,a)=>{if(v=M("LCP",0,i,a),n=l(t,v,z,e.reportAllChanges),o=!1,"soft-navigation"===i){d=b(!0);const t=h(a);r=t&&t.startTime?t.startTime:0}},y=t=>{e.reportAllChanges||i||(t=t.slice(-1));for(const e of t)if(e){i&&e?.navigationId!==v.navigationId&&(o||n(!0),p("soft-navigation",e.navigationId));let t=0;if(e.navigationId&&e.navigationId!==s){const n=h(e.navigationId),o=n&&n.startTime?n.startTime:0;t=Math.max(e.startTime-o,0)}else t=Math.max(e.startTime-g(),0);m.l(e),e.startTime<d.firstHiddenTime&&(v.value=t,v.entries=[e],n())}},E=T("largest-contentful-paint",y,e);if(E){n=l(t,v,z,e.reportAllChanges);const a=t=>{t.isTrusted&&!o&&(c=v.navigationId,R((()=>{o||(y(E.takeRecords()),i||(E.disconnect(),removeEventListener(t.type,a)),v.navigationId===c&&(o=!0,n(!0)))})))};for(const t of["keydown","click","visibilitychange"])addEventListener(t,a,{capture:!0});f((i=>{p("back-forward-cache",v.navigationId),n=l(t,v,z,e.reportAllChanges),u((()=>{v.value=performance.now()-i.timeStamp,o=!0,n(!0)}))}));const s=t=>{t.forEach((t=>{const e=t.navigationId?h(t.navigationId):null;t?.navigationId!==v.navigationId&&(e?.startTime||0)>r&&(y(E.takeRecords()),o||n(!0),p("soft-navigation",t.navigationId))}))};i&&(T("interaction-contentful-paint",y,e),T("soft-navigation",s,e))}}))})((e=>{const o=(t=>{const e=n()?.navigationId||"1";let o={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:t.value};if(t.entries.length){let i,a=0,s=0,c=0;if(t.navigationId&&t.navigationId!==e?(i=h(t.navigationId),c=i?i.startTime:0,a=c):(i=n(),a=i&&i.activationStart?i.activationStart:0,s=i&&i.responseStart?i.responseStart:0),i){const n=t.entries.at(-1),e=n.url&&performance.getEntriesByType("resource").filter((t=>t.name===n.url))[0],f=Math.max(0,s-a),l=Math.max(f,e?(e.requestStart||e.startTime)-a:0),u=Math.min(t.value,Math.max(l-c,e?e.responseEnd-a:0,0));o={target:r.get(n),timeToFirstByte:f,resourceLoadDelay:l-f,resourceLoadDuration:u-l,elementRenderDelay:t.value-u,navigationEntry:i,lcpEntry:n},n.url&&(o.url=n.url),e&&(o.lcpResourceEntry=e)}}return Object.assign(t,{attribution:o})})(e);t(o)}),e)},J=[800,1800],K=t=>{document.prerendering?D((()=>K(t))):"complete"!==document.readyState?addEventListener("load",(()=>K(t)),!0):setTimeout(t)},Q=(t,e={})=>{((t,e={})=>{const o=d(e=e||{});let i=M("TTFB"),r=l(t,i,J,e.reportAllChanges);K((()=>{const a=n();if(a){const n=a.responseStart;i.value=Math.max(n-g(),0),i.entries=[a],r(!0),f((()=>{i=M("TTFB",0,"back-forward-cache",i.navigationId),r=l(t,i,J,e.reportAllChanges),r(!0)})),o&&T("soft-navigation",(n=>{n.forEach((n=>{n.navigationId&&(i=M("TTFB",0,"soft-navigation",n.navigationId),i.entries=[n],r=l(t,i,J,e.reportAllChanges),r(!0))}))}),e)}}))})((n=>{const e=(t=>{let n={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(t.entries.length){const e=t.entries[0],o=e.activationStart||0,i=Math.max((e.workerStart||e.fetchStart||0)-o,0),r=Math.max(e.domainLookupStart-o||0,0),a=Math.max(e.connectStart-o||0,0),s=Math.max(e.connectEnd-o||0,0);n={waitingDuration:i,cacheDuration:r-i,dnsDuration:a-r,connectionDuration:s-a,requestDuration:t.value-s,navigationEntry:e}}return Object.assign(t,{attribution:n})})(n);t(e)}),e)};export{L as CLSThresholds,P as FCPThresholds,U as INPThresholds,z as LCPThresholds,J as TTFBThresholds,k as onCLS,F as onFCP,V as onINP,G as onLCP,Q as onTTFB};
